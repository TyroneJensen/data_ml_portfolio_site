<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analytics Dashboard | Ty Jensen</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="../styles.css">
    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
</head>
<body>
    <div class="background">
        <div class="shapes"></div>
    </div>
    <div class="container">
        <header class="glass-card">
            <h1>Real-time Analytics Dashboard</h1>
            <nav>
                <ul>
                    <li><a href="../index.html">‚Üê Back to Portfolio</a></li>
                </ul>
            </nav>
        </header>

        <main>
            <section class="section glass-card">
                <h2>Project Overview</h2>
                <p>A real-time analytics dashboard built with Python and React, processing millions of events daily to provide actionable insights for e-commerce operations.</p>
            </section>

            <section class="section glass-card">
                <h2>Data Pipeline</h2>
                <div class="details-grid">
                    <div class="detail-item">
                        <h3>Architecture</h3>
                        <ul>
                            <li>Apache Airflow</li>
                            <li>Amazon Redshift</li>
                            <li>dbt for transformations</li>
                        </ul>
                    </div>
                    <div class="detail-item">
                        <h3>Key Metrics</h3>
                        <ul>
                            <li>5M+ daily events</li>
                            <li>99.9% data accuracy</li>
                            <li>Sub-minute latency</li>
                        </ul>
                    </div>
                </div>
                
                <div class="code-block">
                    <pre class="line-numbers"><code class="language-python">from airflow import DAG
from airflow.operators.python import PythonOperator
from datetime import datetime, timedelta

def extract_events():
    """Extract events from Kafka stream"""
    from confluent_kafka import Consumer
    
    consumer = Consumer({
        'bootstrap.servers': 'localhost:9092',
        'group.id': 'analytics_pipeline',
        'auto.offset.reset': 'earliest'
    })
    consumer.subscribe(['user_events'])
    
    batch = []
    while len(batch) < 1000:
        msg = consumer.poll(1.0)
        if msg is None:
            continue
        if msg.error():
            print(f"Consumer error: {msg.error()}")
            continue
        batch.append(msg.value())
    
    return batch

def transform_events(events):
    """Transform events using Pandas"""
    import pandas as pd
    
    df = pd.DataFrame(events)
    
    # Calculate key metrics
    metrics = {
        'total_revenue': df['revenue'].sum(),
        'conversion_rate': len(df[df['converted']]) / len(df),
        'avg_session_duration': df['session_duration'].mean(),
        'top_products': df.groupby('product_id')['revenue'].sum().nlargest(5)
    }
    
    return metrics

default_args = {
    'owner': 'analytics_team',
    'depends_on_past': False,
    'email_on_failure': True,
    'email_on_retry': False,
    'retries': 1,
    'retry_delay': timedelta(minutes=5)
}

with DAG(
    'analytics_pipeline',
    default_args=default_args,
    description='Real-time analytics pipeline',
    schedule_interval=timedelta(minutes=5),
    start_date=datetime(2024, 1, 1),
    catchup=False
) as dag:
    
    extract_task = PythonOperator(
        task_id='extract_events',
        python_callable=extract_events
    )
    
    transform_task = PythonOperator(
        task_id='transform_events',
        python_callable=transform_events
    )
    
    extract_task >> transform_task</code></pre>
                </div>
            </section>

            <section class="section glass-card">
                <h2>Data Modeling</h2>
                <div class="details-grid">
                    <div class="detail-item">
                        <h3>Models</h3>
                        <ul>
                            <li>Star schema design</li>
                            <li>Incremental updates</li>
                            <li>SCD Type 2 tracking</li>
                        </ul>
                    </div>
                    <div class="detail-item">
                        <h3>Transformations</h3>
                        <ul>
                            <li>dbt models</li>
                            <li>Data quality tests</li>
                            <li>Documentation</li>
                        </ul>
                    </div>
                </div>
                
                <div class="code-block">
                    <pre class="line-numbers"><code class="language-sql">-- models/marts/user_behavior.sql
WITH user_sessions AS (
    SELECT
        session_id,
        user_id,
        MIN(event_timestamp) as session_start,
        MAX(event_timestamp) as session_end,
        COUNT(*) as event_count,
        SUM(CASE WHEN event_type = 'purchase' THEN 1 ELSE 0 END) as purchase_count,
        SUM(CASE WHEN event_type = 'purchase' THEN amount ELSE 0 END) as total_spent
    FROM {{ ref('stg_events') }}
    WHERE event_timestamp >= CURRENT_DATE - INTERVAL '30 days'
    GROUP BY 1, 2
),

user_metrics AS (
    SELECT
        user_id,
        COUNT(DISTINCT session_id) as total_sessions,
        AVG(EXTRACT(EPOCH FROM (session_end - session_start))) as avg_session_duration,
        SUM(purchase_count) as total_purchases,
        SUM(total_spent) as lifetime_value,
        AVG(event_count) as avg_events_per_session
    FROM user_sessions
    GROUP BY 1
)

SELECT
    u.*,
    NTILE(5) OVER (ORDER BY lifetime_value DESC) as value_segment,
    CASE 
        WHEN total_sessions >= 10 THEN 'power_user'
        WHEN total_sessions >= 5 THEN 'regular_user'
        ELSE 'new_user'
    END as user_type
FROM user_metrics u</code></pre>
                </div>
            </section>

            <section class="section glass-card">
                <h2>Frontend Visualization</h2>
                <div class="details-grid">
                    <div class="detail-item">
                        <h3>Technologies</h3>
                        <ul>
                            <li>React.js</li>
                            <li>D3.js</li>
                            <li>Material-UI</li>
                        </ul>
                    </div>
                    <div class="detail-item">
                        <h3>Features</h3>
                        <ul>
                            <li>Real-time updates</li>
                            <li>Interactive charts</li>
                            <li>Custom visualizations</li>
                        </ul>
                    </div>
                </div>
                
                <div class="code-block">
                    <pre class="line-numbers"><code class="language-javascript">// components/RevenueChart.tsx
import { useEffect, useRef } from 'react';
import * as d3 from 'd3';
import { useTheme } from '@mui/material';
import { RevenueData } from '../types';

interface Props {
    data: RevenueData[];
    width: number;
    height: number;
}

export const RevenueChart: React.FC<Props> = ({ data, width, height }) => {
    const svgRef = useRef<SVGSVGElement>(null);
    const theme = useTheme();

    useEffect(() => {
        if (!svgRef.current || !data.length) return;

        // Clear previous chart
        d3.select(svgRef.current).selectAll('*').remove();

        // Set up scales
        const xScale = d3.scaleTime()
            .domain(d3.extent(data, d => new Date(d.timestamp)) as [Date, Date])
            .range([50, width - 20]);

        const yScale = d3.scaleLinear()
            .domain([0, d3.max(data, d => d.revenue) as number])
            .range([height - 30, 20]);

        // Create line generator
        const line = d3.line<RevenueData>()
            .x(d => xScale(new Date(d.timestamp)))
            .y(d => yScale(d.revenue))
            .curve(d3.curveMonotoneX);

        // Create SVG
        const svg = d3.select(svgRef.current);

        // Add gradient
        const gradient = svg.append('defs')
            .append('linearGradient')
            .attr('id', 'revenue-gradient')
            .attr('gradientUnits', 'userSpaceOnUse')
            .attr('x1', 0)
            .attr('y1', yScale(0))
            .attr('x2', 0)
            .attr('y2', yScale(d3.max(data, d => d.revenue) as number));

        gradient.append('stop')
            .attr('offset', '0%')
            .attr('stop-color', theme.palette.primary.main)
            .attr('stop-opacity', 0.1);

        gradient.append('stop')
            .attr('offset', '100%')
            .attr('stop-color', theme.palette.primary.main)
            .attr('stop-opacity', 0.6);

        // Add area
        svg.append('path')
            .datum(data)
            .attr('fill', 'url(#revenue-gradient)')
            .attr('d', d3.area<RevenueData>()
                .x(d => xScale(new Date(d.timestamp)))
                .y0(yScale(0))
                .y1(d => yScale(d.revenue))
                .curve(d3.curveMonotoneX)
            );

        // Add line
        svg.append('path')
            .datum(data)
            .attr('fill', 'none')
            .attr('stroke', theme.palette.primary.main)
            .attr('stroke-width', 2)
            .attr('d', line);

        // Add axes
        const xAxis = d3.axisBottom(xScale)
            .ticks(5)
            .tickFormat(d3.timeFormat('%b %d'));

        const yAxis = d3.axisLeft(yScale)
            .ticks(5)
            .tickFormat(d => `$${d3.format(',.0f')(d)}`);

        svg.append('g')
            .attr('transform', `translate(0,${height - 30})`)
            .call(xAxis);

        svg.append('g')
            .attr('transform', 'translate(50,0)')
            .call(yAxis);

    }, [data, width, height, theme]);

    return (
        <svg
            ref={svgRef}
            width={width}
            height={height}
            style={{ overflow: 'visible' }}
        />
    );
};</code></pre>
                </div>
            </section>

            <section class="section glass-card">
                <h2>Technical Implementation</h2>
                <div class="code-block">
                    <pre><code class="language-python"># Dashboard data processing
def process_analytics_data(raw_data):
    df = clean_and_transform(raw_data)
    metrics = calculate_key_metrics(df)
    visualizations = generate_visualizations(df)
    return metrics, visualizations

# Real-time updates
def update_dashboard():
    while True:
        new_data = fetch_latest_data()
        metrics, viz = process_analytics_data(new_data)
        broadcast_updates(metrics, viz)
        time.sleep(UPDATE_INTERVAL)</code></pre>
                </div>
            </section>

            <section class="section glass-card">
                <h2>Results & Impact</h2>
                <ul>
                    <li>50% reduction in data processing time</li>
                    <li>95% user satisfaction rate</li>
                    <li>30% increase in data-driven decisions</li>
                    <li>Real-time insights for 100+ daily users</li>
                </ul>
            </section>
        </main>

        <footer class="glass-card">
            <p>&copy; 2024 Ty Jensen. All rights reserved.</p>
            <div class="project-links">
                <a href="https://github.com/yourusername/analytics-dashboard" target="_blank" class="github-link">
                    <svg class="github-icon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 0C5.37 0 0 5.37 0 12c0 5.3 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61-.546-1.385-1.335-1.755-1.335-1.755-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.605-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 21.795 24 17.295 24 12c0-6.63-5.37-12-12-12"></path>
                    </svg>
                    View on GitHub
                </a>
            </div>
        </footer>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-sql.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
    <script src="../script.js"></script>
</body>
</html>
